const translations = {
    th: {
        app_title: "üëÅÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πà‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        app_subtitle: "‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢ AI ‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡∏≤‡πÅ‡∏•‡∏∞‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
        login_title: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö",
        login_error: "‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á",
        label_email: "‡∏≠‡∏µ‡πÄ‡∏°‡∏•",
        label_password: "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô",
        placeholder_email: "‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
        placeholder_password: "‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
        btn_signin: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö",
        switch_to_register: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? <a id=\"show-register-btn\" style=\"cursor:pointer; color:#00d4ff;\">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</a>",
        register_title: "‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",
        register_error: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",
        label_username: "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ",
        placeholder_username: "‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
        btn_register: "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ",
        switch_to_login: "‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? <a id=\"show-login-btn\" style=\"cursor:pointer; color:#00d4ff;\">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</a>",
        stat_blink: "‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏ï‡∏≤",
        stat_eye: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡∏ß‡∏á‡∏ï‡∏≤",
        stat_dist: "‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á",
        stat_user: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ",
        stat_logged_in: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô",
        btn_logout: "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö",
        ai_advisor_title: "ü§ñ ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢ AI",
        btn_ai_advice: "‚ú® ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥",
        ai_advice_desc: "‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° \"‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥\" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
        settings_title: "‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤",
        setting_camera: "‡∏Å‡∏•‡πâ‡∏≠‡∏á",
        setting_dist_sens: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞",
        setting_blink_sens: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏ï‡∏≤",
        setting_alert_time: "‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)",
        setting_notification: "‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        setting_sound: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        btn_test_sound: "‚ñ∂Ô∏è ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á",
        btn_ringtone: "üéµ Ringtone",
        setting_20_20_20: "‚è∞ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤ 20-20-20",
        btn_setting_20_20_20: "üïê ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏é 20-20-20",
        timer_title: "‚è±Ô∏è 20-20-20 Rule Timer",
        timer_work: "‚è±Ô∏è ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:",
        timer_break: "‚òï ‡∏û‡∏±‡∏Å:",
        timer_dist: "üëÄ ‡∏£‡∏∞‡∏¢‡∏∞‡∏°‡∏≠‡∏á:",
        alert_warning: "‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô!",
        alert_too_close: "‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏±‡πà‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏à‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏°‡∏≤",
        break_title: "‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏™‡∏≤‡∏¢‡∏ï‡∏≤!",
        break_desc: "‡∏ï‡∏≤‡∏°‡∏Å‡∏é 20-20-20<br>‡∏°‡∏≠‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏£‡∏∞‡∏¢‡∏∞ 20 ‡∏ü‡∏∏‡∏ï (6 ‡πÄ‡∏°‡∏ï‡∏£)<br>‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ 20 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ",
        btn_skip_break: "‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å",
        timer_settings_title: "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏é 20-20-20",
        setting_work_time: "‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡∏ô‡∏≤‡∏ó‡∏µ)",
        setting_break_time: "‚òï ‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏±‡∏Å (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)",
        setting_view_dist: "üëÄ ‡∏£‡∏∞‡∏¢‡∏∞‡∏°‡∏≠‡∏á (‡∏ü‡∏∏‡∏ï)",
        btn_reset: "üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï",
        btn_default: "üîô ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°",
        btn_ok: "‚úÖ ‡∏ï‡∏Å‡∏•‡∏á",
        ringtone_title: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        btn_close: "‚úÖ ‡∏õ‡∏¥‡∏î",
        unit_min: "‡∏ô‡∏≤‡∏ó‡∏µ",
        unit_sec: "‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ",
        unit_foot: "‡∏ü‡∏∏‡∏ï",
        camera_on: "üé• ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà",
        camera_off: "üé• ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà",
        noti_on: "üîî ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        noti_off: "üîï ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        sound_on: "üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        sound_off: "üîá ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
        status_active: "‡πÄ‡∏õ‡∏¥‡∏î",
        status_inactive: "‡∏õ‡∏¥‡∏î",
        status_too_close: "‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ!",
        status_ok: "OK",
        presence_active: "‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠",
        presence_inactive: "‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠",
        ai_analyzing: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•... ‚è≥",
        ai_advice_prefix: "üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:",
        ai_error: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ",
        ai_network_error: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå",
        break_msg_1: "‡∏ï‡∏≤‡∏°‡∏Å‡∏é 20-20-20<br>‡∏°‡∏≠‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏£‡∏∞‡∏¢‡∏∞",
        break_msg_2: "‡∏ü‡∏∏‡∏ï",
        break_msg_3: "‡πÄ‡∏°‡∏ï‡∏£)<br>‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤",
        ringtone_selected: "‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß",
        ringtone_click_to_select: "‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å",
        ringtone_play: "‚ñ∂Ô∏è ‡∏ü‡∏±‡∏á"
    },
    en: {
        app_title: "üëÅÔ∏è Eye-Rest Monitor",
        app_subtitle: "AI-Powered Eye Health & Posture Guardian",
        login_title: "Login",
        login_error: "Incorrect email or password",
        label_email: "Email",
        label_password: "Password",
        placeholder_email: "Enter your email",
        placeholder_password: "Enter your password",
        btn_signin: "Sign In",
        switch_to_register: "Don't have an account? <a id=\"show-register-btn\" style=\"cursor:pointer; color:#00d4ff;\">Register here</a>",
        register_title: "Register",
        register_error: "Error registering account",
        label_username: "Username",
        placeholder_username: "Choose a username",
        btn_register: "Create Account",
        switch_to_login: "Already have an account? <a id=\"show-login-btn\" style=\"cursor:pointer; color:#00d4ff;\">Login here</a>",
        stat_blink: "Blink Count",
        stat_eye: "Eye Status",
        stat_dist: "Distance",
        stat_user: "User Status",
        stat_logged_in: "Logged in as",
        btn_logout: "Logout",
        ai_advisor_title: "ü§ñ AI Advisor",
        btn_ai_advice: "‚ú® Get Advice",
        ai_advice_desc: "Click \"Get Advice\" to let AI analyze your usage statistics.",
        settings_title: "‚öôÔ∏è Settings",
        setting_camera: "Camera",
        setting_dist_sens: "Distance Sensitivity",
        setting_blink_sens: "Blink Sensitivity",
        setting_alert_time: "Too Close Alert Time (sec)",
        setting_notification: "Notifications",
        setting_sound: "Alert Sound",
        btn_test_sound: "‚ñ∂Ô∏è Test Sound",
        btn_ringtone: "üéµ Ringtone",
        setting_20_20_20: "‚è∞ 20-20-20 Rule Settings",
        btn_setting_20_20_20: "üïê Configure 20-20-20 Rule",
        timer_title: "‚è±Ô∏è 20-20-20 Rule Timer",
        timer_work: "‚è±Ô∏è Work:",
        timer_break: "‚òï Break:",
        timer_dist: "üëÄ View Dist:",
        alert_warning: "‚ö†Ô∏è Warning!",
        alert_too_close: "You are sitting too close to the screen. Please move back.",
        break_title: "Time for a Screen Break!",
        break_desc: "Following the 20-20-20 rule<br>Look at an object 20 feet (6 meters) away<br>for 20 seconds",
        btn_skip_break: "Skip Break",
        timer_settings_title: "Configure 20-20-20 Rule",
        setting_work_time: "‚è±Ô∏è Work Time (min)",
        setting_break_time: "‚òï Break Time (sec)",
        setting_view_dist: "üëÄ Viewing Distance (ft)",
        btn_reset: "üîÑ Reset",
        btn_default: "üîô Default",
        btn_ok: "‚úÖ OK",
        ringtone_title: "Choose Alert Sound",
        btn_close: "‚úÖ Close",
        unit_min: "min",
        unit_sec: "sec",
        unit_foot: "ft",
        camera_on: "üé• Camera On",
        camera_off: "üé• Camera Off",
        noti_on: "üîî Notifications On",
        noti_off: "üîï Notifications Off",
        sound_on: "üîä Sound On",
        sound_off: "üîá Sound Off",
        status_active: "Open",
        status_inactive: "Closed",
        status_too_close: "Too Close!",
        status_ok: "OK",
        presence_active: "At Screen",
        presence_inactive: "Away",
        ai_analyzing: "Analyzing data... ‚è≥",
        ai_advice_prefix: "üí° Advice:",
        ai_error: "Unable to get AI advice at this time",
        ai_network_error: "Error connecting to server",
        break_msg_1: "Following the 20-20-20 rule<br>Look at an object",
        break_msg_2: "feet",
        break_msg_3: "meters) away<br>for",
        ringtone_selected: "‚úÖ Selected",
        ringtone_click_to_select: "Click to select",
        ringtone_play: "‚ñ∂Ô∏è Play"
    }
};

let currentLang = localStorage.getItem('appLang') || 'th';

function applyLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('appLang', lang);

    // Update active button styling
    const btnTh = document.getElementById('lang-btn-th');
    const btnEn = document.getElementById('lang-btn-en');

    if (btnTh && btnEn) {
        if (lang === 'th') {
            btnTh.style.background = 'rgba(0, 212, 255, 0.3)';
            btnEn.style.background = 'rgba(255, 255, 255, 0.1)';
        } else {
            btnEn.style.background = 'rgba(0, 212, 255, 0.3)';
            btnTh.style.background = 'rgba(255, 255, 255, 0.1)';
        }
    }

    const dict = translations[lang];
    if (!dict) return;

    // elements with data-key
    document.querySelectorAll('[data-key]').forEach(el => {
        const key = el.getAttribute('data-key');
        if (dict[key]) {
            el.innerHTML = dict[key];
        }
    });

    // elements with data-key-placeholder
    document.querySelectorAll('[data-key-placeholder]').forEach(el => {
        const key = el.getAttribute('data-key-placeholder');
        if (dict[key]) {
            el.setAttribute('placeholder', dict[key]);
        }
    });

    // special handlers for re-attaching event listeners if innerHTML changed links
    const showRegisterBtn = document.getElementById('show-register-btn');
    const showLoginBtn = document.getElementById('show-login-btn');
    const loginFormContainer = document.getElementById('login-form-container');
    const registerFormContainer = document.getElementById('register-form-container');
    const loginError = document.getElementById('login-error');
    const registerError = document.getElementById('register-error');

    if (showRegisterBtn) {
        showRegisterBtn.addEventListener('click', () => {
            loginFormContainer.style.display = 'none';
            registerFormContainer.style.display = 'block';
            loginError.style.display = 'none';
        });
    }
    if (showLoginBtn) {
        showLoginBtn.addEventListener('click', () => {
            registerFormContainer.style.display = 'none';
            loginFormContainer.style.display = 'block';
            registerError.style.display = 'none';
        });
    }

    // specific status texts updates if needed, e.g. toggle buttons might need re-evaluation
    // Note: If toggle buttons have state text (e.g. "Camera On" vs "Camera Off"), 
    // it's better to update those in the main logic, so we dispatch an event to let renderer.js know
    window.dispatchEvent(new CustomEvent('languageChanged', { detail: lang }));
}

function setLanguage(lang) {
    applyLanguage(lang);
}

// Initial application
document.addEventListener('DOMContentLoaded', () => {
    applyLanguage(currentLang);
});
